<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YOLO11 Object Detection | Professional Pipeline</title>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Styles -->
    <link rel="stylesheet" href="style.css?v=5">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <div class="app-container">
        <!-- Top Navigation Bar -->
        <header class="app-header">
            <div class="header-left">
                <div class="logo">
                    <i class="fa-solid fa-layer-group"></i>
                    <span>Object Detection Studio</span>
                </div>
            </div>

            <nav class="main-nav">
                <ul>
                    <li class="active" id="nav-dashboard"><i class="fa-solid fa-house"></i> Dashboard</li>
                    <li id="nav-review"><i class="fa-solid fa-check-double"></i> Review Hub</li>
                </ul>
            </nav>

            <div class="header-right">
                <div class="status-panel">
                    <div class="status-item">
                        <span class="label">Backend Status:</span>
                        <span class="value" id="statusValue"><i class="fa-solid fa-circle-question"></i> Unknown</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Body Wrapper -->
        <div class="app-body">
            <!-- Sidebar (Details Only) -->
            <aside class="sidebar">
                <div class="info-panel">
                    <h3>Project Details</h3>
                    <p><strong>Pipeline:</strong> End-to-End Object Detection</p>
                    <p><strong>Tools Used:</strong></p>
                    <div class="tags">
                        <span class="tag">YOLO11</span>
                        <span class="tag">FastAPI</span>
                        <span class="tag">Hugging Face</span>
                        <span class="tag">W&B</span>
                        <span class="tag">Docker</span>
                    </div>
                </div>
            </aside>

            <!-- Main Content -->
            <main class="main-content">

                <!-- VIEW: DASHBOARD -->
                <div id="dashboard-view">
                    <header class="view-header">
                        <h1>Object Detection Studio</h1>
                        <p>Upload an image to detect objects like chairs, boxes, documents and house.</p>
                    </header>

                    <div class="workspace">
                        <!-- Dropzone -->
                        <div class="upload-area" id="dropzone">
                            <input type="file" id="fileInput" accept="image/*" hidden>
                            <div class="upload-content">
                                <i class="fa-solid fa-cloud-arrow-up icon"></i>
                                <h3>Drag & Drop or Click to Upload</h3>
                                <p>Support for JPG, PNG, WEBP</p>
                            </div>
                            <img id="previewImage" class="preview-image hidden">
                        </div>

                        <!-- Analysis Controls -->
                        <div class="analysis-controls">
                            <button id="analyzeBtn" class="btn-primary" disabled>
                                <i class="fa-solid fa-bolt"></i> Analyze Image
                            </button>
                        </div>

                        <!-- Results View -->
                        <div class="results-area hidden" id="resultsArea">
                            <div class="canvas-wrapper">
                                <img id="sourceImage" src="" alt="Source">
                                <canvas id="detectionCanvas"></canvas>
                                <div class="loader-overlay hidden" id="loader">
                                    <div class="spinner"></div>
                                    <p>Processing...</p>
                                </div>
                            </div>

                            <div class="metrics-panel">
                                <div class="metric-card">
                                    <span class="metric-value" id="detectionCount">0</span>
                                    <span class="metric-label">Detections</span>
                                </div>
                                <div class="metric-card">
                                    <span class="metric-value" id="avgConf">0%</span>
                                    <span class="metric-label">Avg Confidence</span>
                                </div>
                            </div>

                            <button class="btn-reset" id="resetBtn">
                                <i class="fa-solid fa-rotate-right"></i> Analyze Another
                            </button>
                        </div>
                    </div>
                </div>

                <!-- VIEW: REVIEW HUB -->
                <div id="review-view" class="hidden">
                    <header class="view-header">
                        <h1>Data Review Hub</h1>
                        <p>Verify network predictions to improve the dataset quality.</p>
                    </header>

                    <div class="workspace review-workspace">
                        <!-- Review Image Container -->
                        <div class="review-image-area">
                            <div class="canvas-wrapper">
                                <img id="reviewImage" src="" alt="Review Data">
                                <canvas id="reviewCanvas"></canvas>
                                <div id="reviewLoader" class="loader-overlay hidden">
                                    <div class="spinner"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Review Validation Controls -->
                        <div class="review-controls-panel">
                            <h3>Validate Prediction</h3>
                            <p id="reviewFilename" class="filename-display hidden">Select an image...</p>

                            <!-- Debug Trigger for User Visibility -->
                            <button id="btnDebugTrigger" class="btn-secondary"
                                style="margin-bottom: 1rem; background: #4b5563; width: 100%;">
                                <i class="fa-solid fa-bug"></i> Force Retrain (Debug Check)
                            </button>

                            <div class="actions">
                                <button id="btnVerify" class="btn-success">
                                    <i class="fa-solid fa-check"></i> Correct
                                </button>

                                <button id="btnWrong" class="btn-danger">
                                    <i class="fa-solid fa-xmark"></i> Wrong
                                </button>
                            </div>

                            <!-- Correction UI (Hidden by default) -->
                            <div id="correctionPanel" class="correction-panel hidden">
                                <label>Select Correct Label:</label>
                                <select id="correctLabelSelect">
                                    <option value="chair">Chair</option>
                                    <option value="box">Box</option>
                                    <option value="document">Document</option>
                                    <option value="house">House</option>
                                    <option value="none">None / Background</option>
                                </select>
                                <button id="btnSubmitCorrection" class="btn-primary">
                                    <i class="fa-solid fa-paper-plane"></i> Save Fix
                                </button>
                            </div>

                            <button id="btnNextImage" class="btn-secondary">
                                Skip / Next Image <i class="fa-solid fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Process & Visualization -->
                <!-- Detailed Pipeline Visualization -->
                <div class="pipeline-section">

                    <!-- Flow 1: Application Workflow (The User Experience) -->
                    <div class="visualization-group">
                        <h2><i class="fa-solid fa-bolt"></i> Application Workflow (Runtime)</h2>
                        <div class="pipeline-flow">
                            <div class="step"
                                data-tooltip="The user selects an image. The frontend uses HTML5 Drag & Drop API to capture the file.">
                                <div class="step-icon"><i class="fa-solid fa-upload"></i></div>
                                <p>Upload</p>
                            </div>
                            <div class="connector">
                                <div class="dot"></div>
                            </div>

                            <div class="step"
                                data-tooltip="JavaScript (Canvas API) automatically resizes large images to 1024px to ensure fast upload and inference speeds locally.">
                                <div class="step-icon"><i class="fa-solid fa-crop-simple"></i></div>
                                <p>Client Resize</p>
                            </div>
                            <div class="connector">
                                <div class="dot"></div>
                            </div>

                            <div class="step"
                                data-tooltip="The resized image is sent via a POST request to the FastAPI Backend hosted on Hugging Face Spaces.">
                                <div class="step-icon"><i class="fa-solid fa-server"></i></div>
                                <p>FastAPI API</p>
                            </div>
                            <div class="connector">
                                <div class="dot"></div>
                            </div>

                            <div class="step"
                                data-tooltip="The YOLO11 model (Torch) processes the tensor to detect objects, returning bounding box coordinates and confidence scores.">
                                <div class="step-icon"><i class="fa-solid fa-brain"></i></div>
                                <p>YOLO Inference</p>
                            </div>
                            <div class="connector">
                                <div class="dot"></div>
                            </div>

                            <div class="step"
                                data-tooltip="The browser receives JSON data and uses the Canvas API to draw colorful bounding boxes and labels over the original image.">
                                <div class="step-icon"><i class="fa-solid fa-pen-nib"></i></div>
                                <p>Draw Results</p>
                            </div>
                        </div>
                    </div>

                    <hr class="divider">

                    <!-- Flow 2: Development Pipeline (The Architecture) -->
                    <div class="visualization-group">
                        <h2><i class="fa-solid fa-gears"></i> Development & MLOps Pipeline</h2>
                        <div class="pipeline-flow">
                            <div class="step"
                                data-tooltip="Code changes are pushed to GitHub. This acts as the single source of truth for the project versioning.">
                                <div class="step-icon"><i class="fa-brands fa-github"></i></div>
                                <p>GitHub</p>
                            </div>
                            <div class="connector">
                                <div class="dot"></div>
                            </div>

                            <div class="step"
                                data-tooltip="GitHub Actions detects changes and triggers the CI/CD workflow to automatically sync code to the deployment server.">
                                <div class="step-icon"><i class="fa-solid fa-rotate"></i></div>
                                <p>CI/CD Automation</p>
                            </div>
                            <div class="connector">
                                <div class="dot"></div>
                            </div>

                            <div class="step"
                                data-tooltip="The application is packaged into a Docker container, ensuring consistent dependencies (Python, OpenCV, Pytorch) across environments.">
                                <div class="step-icon"><i class="fa-brands fa-docker"></i></div>
                                <p>Docker Build</p>
                            </div>
                            <div class="connector">
                                <div class="dot"></div>
                            </div>

                            <div class="step"
                                data-tooltip="The container is deployed to Hugging Face Spaces (Cloud), making the application accessible globally via HTTPS.">
                                <div class="step-icon"><i class="fa-solid fa-cloud"></i></div>
                                <p>HF Spaces</p>
                            </div>
                            <div class="connector">
                                <div class="dot"></div>
                            </div>

                            <div class="step"
                                data-tooltip="Inference data is logged to Weights & Biases (W&B) for monitoring, and raw images are saved to HF Datasets for future training.">
                                <div class="step-icon"><i class="fa-solid fa-chart-line"></i></div>
                                <p>MLOps Logging</p>
                            </div>
                        </div>
                    </div>

                </div>
            </main>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>